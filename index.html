<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {font-family: Arial;}

/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
}
.myButton {
	box-shadow: 4px 5px 0px 0px #b2dbff;
	background:linear-gradient(to bottom, #79bbff 5%, #378de5 100%);
	background-color:#79bbff;
	border-radius:14px;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Arial;
	font-size:20px;
	font-weight:bold;
	padding:10px 10px;
	text-decoration:none;
	text-shadow:0px 1px 0px #528ecc;
}
.myButton:hover {
	background:linear-gradient(to bottom, #378de5 5%, #79bbff 100%);
	background-color:#378de5;
}
.myButton:active {
	position:relative;
	top:1px;
}

.hilight{
	color:#ff0000;
}

mark {
  background-color: yellow;
  color: black;
}
</style>
</head>
<body>

<div class="">
	<button class="myButton" onclick="openCity(event, 'Error')">Error</button>
	<button class="myButton" onclick="openCity(event, 'Start')">Start</button>
	<button class="myButton" onclick="openCity(event, 'Text')">Text</button>	
	<button class="myButton" onclick="openCity(event, 'ngFor')">ngFor</button>
	<button class="myButton" onclick="openCity(event, 'Array')">Array</button>
	<button class="myButton" onclick="openCity(event, 'Input')">Input</button>
	<button class="myButton" onclick="openCity(event, 'Interval')">Interval</button>
	<button class="myButton" onclick="openCity(event, 'Map')">Map</button>
	<button class="myButton" onclick="openCity(event, 'Excel')">Excel</button>
	<button class="myButton" onclick="openCity(event, 'ElementById')">ElementById</button>
	<button class="myButton" onclick="openCity(event, 'swal')">swal</button>
	<button class="myButton" onclick="openCity(event, 'button')">button</button>
	<button class="myButton" onclick="openCity(event, 'Storage')">Storage</button>
	<button class="myButton" onclick="openCity(event, 'Save')">Save</button>
	<button class="myButton" onclick="openCity(event, 'NodeJS')">NodeJS</button>
	<button class="myButton" onclick="openCity(event, 'Material')">Material</button>
	<button class="myButton" onclick="openCity(event, 'Install')">Install</button>
	<button class="myButton" onclick="openCity(event, 'Dialog')">Dialog</button>
	<button class="myButton" onclick="openCity(event, 'Object')">Object</button>
	<button class="myButton" onclick="openCity(event, 'CPN')">CPN</button>
	<button class="myButton" onclick="openCity(event, 'FormGroup')">FormGroup</button>
	<button class="myButton" onclick="openCity(event, 'Holiday')">Holiday</button>
	<button class="myButton" onclick="openCity(event, 'ElementNative')">ElementNative</button>
	<button class="myButton" onclick="openCity(event, 'CSS')">CSS</button>
	<button class="myButton" onclick="openCity(event, 'AG_Grid')">AG_Grid</button>
	<button class="myButton" onclick="openCity(event, 'RouteGuard')">RouteGuard</button>
	<button class="myButton" onclick="openCity(event, 'Copy')">Copy</button>
	<button class="myButton" onclick="openCity(event, 'MongoDB')">MongoDB</button>
	<button class="myButton" onclick="openCity(event, 'Number')">Number</button>
	<button class="myButton" onclick="openCity(event, 'Date')">Date</button>
	<button class="myButton" onclick="openCity(event, 'Autocomplete')">Autocomplete</button>
	<button class="myButton" onclick="openCity(event, 'Echart')">Echart</button>
	<button class="myButton" onclick="openCity(event, 'PrimeNG')">PrimeNG</button>
	<button class="myButton" onclick="openCity(event, 'HTML')">HTML</button>
	<button class="myButton" onclick="openCity(event, 'PDF')">PDF</button>
	<button class="myButton" onclick="openCity(event, 'QR_Code')">QR Code</button>
	<button class="myButton" onclick="openCity(event, 'UPLOAD')">UPLOAD</button>
	<button class="myButton" onclick="openCity(event, 'AntDesign')">AntDesign</button>
	<button class="myButton" onclick="openCity(event, 'loading')">loading</button>
	<button class="myButton" onclick="openCity(event, 'setAccess')">Access</button>
	
</div>
  
  <!--<mark></mark>--->

<div id="Error" class="tabcontent">
<pre>
ลบไฟล์ Node_modules , package-lock , npm i --force	
</pre>
</div>	

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Start" class="tabcontent">
<pre>

new Date(new Date(req.body.data.start).getTime() + 86400000)
//TODO Start
ng new cube-bit --routing
ng b --output-path docs --base-href /cube-bit/
ng add @angular/material@14.0.0
npm install bootstrap@4.0.0
ng add @ng-bootstrap/ng-bootstrap
npm install sweetalert2
npm install bootstrap bootstrap-icons
npm i moment
npm i --save-dev @types/file-saver
npm i exceljs
npm i xlsx


"schematics": {
"@schematics/angular:component": {
  "style": "scss",
  <mark>"standalone": false</mark>
}
},
FormsModule
CommonModule
	
npm i material-icons
@import 'material-icons/iconfont/material-icons.css';

<a [routerLink]="['/ITAssetTakeout']" [routerLinkActive]="['is-active']">Home</a>s
ng g service auth-guard

"styles": [
  "node_modules/bootstrap/scss/bootstrap.scss",
  "node_modules/bootstrap-icons/font/bootstrap-icons.css",
  "src/styles.scss"
],
"scripts": [
  "node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"
]

//TODO scroll
const tableWrapper_2: any = document.getElementById('tableWrapper_2');
tableWrapper_2.scrollLeft = tableWrapper_2.scrollWidth - tableWrapper_2.clientWidth;


 let aas = document.querySelector('div.ag-body-horizontal-scroll-viewport');
 aas?.scrollBy(999999, 0)
//TODO comment
/*#region RegionName*/
	"text"
/*#endregion RegionName*/
</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Text" class="tabcontent">
<pre>
//
  const filteredData = xlData3.filter((e) => {
    const pattern1 = new RegExp(d.NAME_1?.slice(0, 4), "i");
    const pattern2 = new RegExp(d.NAME_1, "i");
    return pattern1.test(e["Location Description"]) || pattern2.test(e["Location Description"]);
  });


this.route.navigate(['/AppliedList'],{queryParamsHandling: 'preserve'}).then((v: any) => {
          window.location.reload()
          let res = localStorage.setItem("IT-asset-takeout-login", JSON.stringify(login[0]))
        })



this.router.navigate(['/ITAssetTakeout'], {
      relativeTo: this.route,
      queryParams: { id: "123" },
      queryParamsHandling: 'merge'
    });


//
  constructor(
    private api: HttpService,
    private router: Router,
    private route:ActivatedRoute
  ) { }

  async ngOnInit(): Promise<void> {
    this.route.queryParams.subscribe(res=>{
      console.log(res['id']);

    })


//TODO replace
  replace(data : any,old :string ,strNew :string) {
    return JSON.parse(JSON.stringify(data).replace(new RegExp(old, "g"), "0"));
  }
<mark>this.replace(this.data,"-","0")</mark>


//TODO center D-flex
<mark>d-flex align-items-center justify-content-center</mark>

//TODO readFileText
readFileText(e: any) {
      const input = e.target;
      const reader = new FileReader();
      reader.onload = (e: any) => {
        const text = reader.result;
      };

      reader.readAsText(input.files[0]);
      }

//TODO filler obj
let doo = this.Master.filter(({ key }) => key.toString().match(new RegExp('123123', "g")));
or
let res = this.data.filter((d: any) => d["Model Code"].match(new RegExp('17', "i")));
or
let loo = this.employee.filter((d: any) => ["TH0286/14", "TH0289/14", "TH0297/14"].includes(d.employee));
or
const licenses = ["กด 3345", "กด 4456", "กด 5567", "กด 6678", "กด 7789"];
const filteredLicenses = licenses.filter(license => /5/i.test(license));
or
const pattern = new RegExp('5', 'i');
const filteredLicenses = licenses.filter(license => pattern.test(license));
const filteredData = data.filter(item => pattern.test(item.license));
or
let models = ["5PV48150","5PV60250"];
let regexPattern = models.join("|");
let regex = new RegExp(regexPattern, 'i');
let ss = rawdata.filter((d: any) => regex.test(d.Model))
or 

// const patterns = [
//   { field: 'code_inspector', pattern: new RegExp(this.searchValue?.code_inspector, 'i') },
//   { field: 'name', pattern: new RegExp(this.searchValue?.name, 'i') }
// ];

const patterns = Object.keys(this.searchValue).map(key => {
return { field: key, pattern: new RegExp(this.searchValue[key], 'i') };
});

this.listOfDisplayData = this.dataTable.filter((item: any) =>
patterns.every(cond => cond.pattern.test(item[cond.field])) // AND operation (every)
);


	  

//TODO filter data obj.array
let beautyProducts = this.stateGroups_1.filter(d => d.names.some(cat => cat.id === 43));


//TODO obj.array
let array1 = [15,10];
let array2 = [
	{a: 2, value: [1, 2, 3]},
	{a: 3, value: [4, 5, 6]},
	{a: 4, value: [7, 8, 9]},
	{a: 5, value: [10, 11, 12]},
	{a: 6, value: [13, 14, 15]}
];

let sss = array2.filter((obj: any) => obj.value.some((val: any) => array1.includes(val)));

//TODO WT
function download(text, filename){
      var blob = new Blob([text], {type: "text/plain"});
      var url = window.URL.createObjectURL(blob);
      var a = document.createElement("a");
      a.href = url;
      a.download = filename;
      a.click();
    }

    download("this is the file", "text.txt");


//TODO readText

<mark>let dataRaw: any = await this.readFileContent(e.target.files[0])</mark>
readFileContent(file: File): Promise<string> {
    return new Promise<string>((resolve, reject) => {
      if (!file) {
        reject('no file')
      }
      const reader: any = new FileReader();

      reader.onload = (e: any) => {
        const text = reader.result.toString();
        let splitText = text.split('\n')
        if (!splitText || splitText.length == 0) {
          reject('data not correct')
        }
        splitText = splitText.map((t: any) => t.split('\t'))
        if (!splitText || splitText.length == 0) {
          reject('data not correct')
        }
        const header = splitText.shift()
        const body = splitText
        const a_obj = body.map((b: any, i: any) => {
          return loopObj(header, b)
        })
        if (!a_obj || a_obj.length == 0) {
          reject('data not correct')
        }
        resolve(a_obj);
      };
      reader.readAsText(file);
    });

    function loopObj(header: any[], body: any[]) {
      const newArr = header.map((h: any, i: number) => {
        const key = h
        const obj: any = {}
        obj[key] = body[i]
        return obj
      })
      const newObj = newArr.reduce((prev: any, now: any) => {
        return prev = {
          ...prev, ...now
        }
      }, {})
      return newObj
    }


  }




//TODO
const replacements = {
"{{reqNo}}": reqNo,
"{{to_mail}}": to_mail,
};

new_data.body = Object.keys(replacements).reduce(
(body, key) => body?.replaceAll(key, replacements[key]),
new_data.body
);


</pre>
</div>


<!--------------------------------------------------------------------------------------------------------------------------------------------->

<div id="FormGroup" class="tabcontent">
<pre>
//TODO formGroup
html ?
	  <form [formGroup]="stateForm">
              <input class="form-control" type="text"
                     matInput
                     formControlName="stateGroup_1"
                     required
                     [matAutocomplete]="autoGroup"
                     (keydown)="Debug()">
                <mat-autocomplete #autoGroup="matAutocomplete"  >
                  <mat-optgroup *ngFor="let group of stateGroupOptions | async" [label]="group.letter">
                    <mat-option *ngFor="let name of group.names" [value]="name">
                      {{name}}
                    </mat-option>
                </mat-optgroup>
              </mat-autocomplete>
          </form>

ts ?
import { lastValueFrom,Observable } from 'rxjs';
import {startWith, map} from 'rxjs/operators';

stateForm = new FormGroup({
   stateGroup:new FormControl(''),

   stateGroup_1:new FormControl(''),
   stateGroup_2:new FormControl(''),
   stateGroup_3:new FormControl(''),
})


stateGroups: StateGroup[] = []
stateGroupOptions!: Observable<StateGroup[]>;


private _filterGroup(value: string): StateGroup[] {
    if (value) {
      return this.stateGroups
        .map(group => ({letter: group.letter, names: _filter(group.names, value)}))
        .filter(group => group.names.length > 0);
    }

    return this.stateGroups;
}


return {
   letter: "",
   names: [""]
}


this.stateGroups = [{
   letter: "",
   names: [""]
}]


this.stateGroupOptions = this.stateForm.get('stateGroup')!.valueChanges.pipe(
   startWith(''),
   map(value => this._filterGroup(value || '')),
);

export interface StateGroup {
  letter: string;
  names: string[];
}

export const _filter = (opt: string[], value: string): string[] => {
  const filterValue = value.toLowerCase();

  return opt.filter(item => item.toLowerCase().includes(filterValue));
};


 Debug(){
    console.log(this.stateForm.value);
  }

</pre>
</div>





<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="ngFor" class="tabcontent">
<pre>
//TODO array เริ่มที่ 1
*ngFor="let item of items | <mark>slice:1;</mark> let i = index;


//TODO index in loop
for (const <mark>[index,value]</mark> of this.data.<mark>entries()</mark>)

//TODO enter dropdown 1
*ngFor="let item of array;let i = index"
[id]="'drop'+i" placeholder="username" (keyup.enter)="dropdown(i,array)"
dropdown(i:any,x:any){
    if (i < x.length-1) {
      document.getElementById(`drop${i+1}`).focus();
    }
  }
//TODO enter dropdown 2
[id]="('drop'+i)+i_2" placeholder="username" (keyup.enter)="dropdown(i,i_2,array)"
dropdown(i:any,j:any,x:any){
    let max = document.getElementById(`drop${0}${j+1}`)
    if (i < x.length-1) {
      document.getElementById(`drop${i+1}${j}`).focus();
    }else{
      if (max) {
        document.getElementById(`drop${0}${j+1}`).focus();
      }
    }
  }

//TODO แบ่ง array
this.chunkedArray = this.chunkArray(this.myArray, 3);
chunkArray<T>(array: T[], chunkSize: number): T[][] {
    if (chunkSize <= 0) throw new Error('Invalid chunk size');
    const result: T[][] = [];
    for (let i = 0; i < array.length; i += chunkSize) {
      result.push(array.slice(i, i + chunkSize));
    }
    return result;
  }

			      
//dup
 let data: any = [
{ a: 11, b: 22, c: 55 },
{ a: 11, b: 22, c: 55 },
{ a: 22, b: 22, c: 55 }
];


let countMap = data.reduce((item:any ,{a}:any)=>{
item[a] = (item[a] || 0) + 1
return item
},{})


data = data.map((d:any)=>{
return{
...d,
dup : countMap[d.a] > 1
}
})

</pre>
</div>


<!--------------------------------------------------------------------------------------------------------------------------------------------->

<div id="Array" class="tabcontent">
<pre>
//TODO cuttext
console.log(str.slice(31));



//TODO delete array
Array.splice(<mark> i </mark> , 1)


//TODO cut array
Array.split("?")[0]


//TODO Expected output: Array
const animals = ['ant', 'bison', 'camel', 'duck', 'elephant'];
console.log(animals.slice(2)); <mark> ["camel", "duck", "elephant"]</mark>
console.log(animals.slice(2, 4)); <mark> ["camel", "duck"]</mark>


//TODO
const paragraph = 'The quick brown fox jumps over the lazy dog. It barked.';
const regex = /the/i;
const found = paragraph.match(regex);


//TODO Sort
this.temp = sort(this.temp, "BoxNo",0)
function sort(array: any, key: any , mode: any) {
    array = array.sort(function (a: any, b: any) {
      if (mode == 1) {
        return b[key].localeCompare(a[key])
      }else{
        return a[key].localeCompare(b[key])
      }

    })
    return array
  }

//TODO Sort
let loo = this.data.sort((a:any,b:any) => a.model - b.model)


//TODO unique 
const unique = [...new Set(data.map((item:any) => item.group))]; // [ 'A', 'B']


//TODO sort กำหนดได้
const customOrder = ['OVER', 'PENDING', 'PASS'];
    this.data.sort((obj1:any, obj2:any) => {
      const b1Index = customOrder.indexOf(obj1.Temp_Status);
      const b2Index = customOrder.indexOf(obj2.Temp_Status);
      return b1Index - b2Index;
    });



const filteredData = listApprove.filter((item :any) => {
      return item.user_approve.some((nestedItem :any) => nestedItem.email === "wichitchai-w@kyocera.co.tsh");
    });



</pre>
</div>



<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="loading" class="tabcontent">
<pre>
new ng g c loading
	
.loading {
  position: absolute;
  z-index: 99;
  width: -webkit-fill-available;
  height: -webkit-fill-available;
  justify-items: center;
  align-content: center;
  background-color: #8080806e;
}
isActiveLoading:any = false
app-loading *ngIf="isActiveLoading" class="loading"

constructor(
    private sss : AppComponent
  ) { }
use 
thus.sss.isActiveLoading = true //start
thus.sss.isActiveLoading = false //stop	
</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Interval" class="tabcontent">
<pre>
//TODO Interval
import { interval, Subscription } from 'rxjs';
interval: any;

setInterval(()=>{
      console.log("111");
    },1000)

 ngOnDestroy(): void { clearInterval(this.interval) }


</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="setAccess" class="tabcontent">
<pre>
//TODO 
ngOnInit() {
    this.login = JSON.parse(`${localStorage.getItem("user-amt-sample-control")}`)
    this.data = this.getLabelsByAccess(['user'])
  }

  getLabelsByAccess(access: any[]) {
    let list: any = []
    let userAccess = new Set(access);

    //label
    list.push(
      {
        nzTitle: 'Admin',
        nzIcon: 'appstore',
        data: filterLabel([
          { link: "/admin/master", label: "Master management", access: ["admin"] },
          { link: "/admin/user", label: "User management", access: ["admin"] }
        ])
      }
    )

    list.push(
      {
        nzTitle: 'Sample Control',
        nzIcon: 'dashboard',
        data: filterLabel([
          { link: "/dashboard", label: "Dashboard", access: ["admin", "user"] },
          { link: "/sample_control", label: "Sample Control System", access: ["admin", "user"] }
        ])
      }
    )

    list.push(
      {
        nzTitle: 'Download WI',
        nzIcon: 'download',
        data: filterLabel([
          { link: "/wi/control-master", label: "-WI Control master", access: ["admin", "user"] },
          { link: "/wi/limit-sample", label: "-Wi Limit sample", access: ["admin", "user"] },
        ])
      }
    )

    list = list.filter((e: any) => e.data.length != 0)

    function filterLabel(label: any) {
      return label.filter((item: any) =>
        item.access.some((role: any) => userAccess.has(role))
      );
    }

    return list
  }
</pre>
</div>	    
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="AntDesign" class="tabcontent">
<pre>
//TODO TS
modalRef!: NzModalRef
private modal: NzModalService,
 
createTplModal(tplTitle: any, tplContent: any, tplFooter: any): void {
    this.modalRef = this.modal.create({
      nzTitle: tplTitle,
      nzContent: tplContent,
      nzFooter: tplFooter,
      nzMaskClosable: false,
      nzClosable: false,
      nzOnOk: () => console.log('Click ok')
    });
  }
 
//TODO html
 ng-template #customFooter
[nzFooter]="customFooter"
</pre>

<pre>
&lt;nz-row nzGutter="16"&gt;
  &lt;nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="6"&gt;
    &lt;div&gt;Content 1&lt;/div&gt;
  &lt;/nz-col&gt;
  &lt;nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="6"&gt;
    &lt;div&gt;Content 2&lt;/div&gt;
  &lt;/nz-col&gt;
  &lt;nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="6"&gt;
    &lt;div&gt;Content 3&lt;/div&gt;
  &lt;/nz-col&gt;
  &lt;nz-col nzXs="24" nzSm="24" nzMd="12" nzLg="6"&gt;
    &lt;div&gt;Content 4&lt;/div&gt;
  &lt;/nz-col&gt;
&lt;/nz-row&gt;


//TODO table
import { ScrollingModule } from '@angular/cdk/scrolling';
imports: [ScrollingModule]

&lt;cdk-virtual-scroll-viewport
  itemSize="54"
  class="virtual-scroll-container"
  [style.height]="'400px'"
&gt;
  &lt;table class="ant-table"&gt;
    &lt;thead class="ant-table-thead"&gt;
      &lt;tr&gt;
        &lt;th&gt;No.&lt;/th&gt;
        &lt;th&gt;Product Name&lt;/th&gt;
        &lt;th&gt;AMT Mat. Code&lt;/th&gt;
        &lt;th&gt;Spec No.&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody class="ant-table-tbody"&gt;
      &lt;tr *cdkVirtualFor="let data of rowData" class="ant-table-row"&gt;
        &lt;td&gt;{{ data.no }}&lt;/td&gt;
        &lt;td&gt;{{ data.model }}&lt;/td&gt;
        &lt;td&gt;{{ data.partsCode }}&lt;/td&gt;
        &lt;td&gt;{{ data.partsSpec }}&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/cdk-virtual-scroll-viewport&gt;

//TODO filter on table
keyword:any = {}
  listOfDisplayData: any
  search(e:any) {
    let searchValue :any = {}
    searchValue[e] = this.keyword[e].trim()
    const patterns = Object.keys(searchValue).map(key => {
      return { field: key, pattern: new RegExp(searchValue[key], 'i') };
    });
    this.listOfDisplayData = this.rowData.filter((item: any) =>
      patterns.every(cond => cond.pattern.test(item[cond.field])) // AND operation (every)
    );
  }

input type="text" nz-input [(ngModel)]="keyword['no']" (keyup)="search('no')"

</pre>

</div>
   
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="UPLOAD" class="tabcontent">
<pre>
import { Component } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { lastValueFrom, Observable } from 'rxjs';
import { environment } from 'src/environments/environment';

//TODO environment
fileServer: 'http://10.200.90.152:30000/upload/new',
fileServerDelete: 'http://10.200.90.152:30000/delete',

private fileServer = environment.fileServer;
private fileServerDelete = environment.fileServerDelete;

constructor(private http: HttpClient) { }

create(data: any): Observable<any> {
  return this.http.post(`${this.fileServer}`, data);
}
delete(data: any): Observable<any> {
  return this.http.post(`${this.fileServerDelete}`, {path_file: "/MSA/excel/newFileName.txt"});
}


 async del(){
    let file = {
      path_file: "/MSA/excel/newFileName.txt"
    }
    let del = await lastValueFrom(this.delete(file))
  }


  async co_ll(event: any) {
    const originalFile = event.target.files[0];
    const renamedFile = new File([originalFile], 'newFileName.txt', {
      type: originalFile.type,
      lastModified: originalFile.lastModified
    });
    const formData: FormData = new FormData()
    let path = "MSA/excel/"
    formData.append('path', path)
    formData.append('file', renamedFile)
    const resFile = await lastValueFrom(this.create(formData))
  }


//TODO

 onFileChange(event: any): void {
    const target: DataTransfer = <DataTransfer>(event.target);
    if (target.files.length !== 1) {
      alert('กรุณาเลือกไฟล์เพียงไฟล์เดียว');
      return;
    }

    const reader: FileReader = new FileReader();
    reader.onload = (e: any) => {
      const binaryStr: string = e.target.result;
      const workbook: XLSX.WorkBook = XLSX.read(binaryStr, { type: 'binary' });

      // อ่านเฉพาะ Sheet แรก
      const sheetName: string = workbook.SheetNames[0];
      const sheet: XLSX.WorkSheet = workbook.Sheets[sheetName];

      // แปลงข้อมูลใน Sheet เป็น JSON
      let koo  = XLSX.utils.sheet_to_json(sheet, { header: 1 });
      console.log(koo);
    };

    reader.readAsBinaryString(target.files[0]);
  }
<input type="file" (change)="onFileChange($event)" accept=".xlsx, .xls" />	
</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Echart" class="tabcontent">
<pre>
//TODO 
	xAxis: [
        {
          type: 'category',
          data: [1,2,3,4,5,6,7,8,9,10,11,12,13,14],
          position: 'top',
          axisLabel: {
            color: '#333',
            rotate: 0,
            interval: 0,
            formatter: function (value: any) {
              return [
                '{a|1 day}',
                '{b|before}'
              ].join('\n');
            },
            rich: {
              a: {
                color: 'blue',
                fontSize: 6
              },
              b: {
                color: 'red',
                fontSize: 6
              }
            }
          },
          gridIndex: 1 // ระบุให้ xAxis นี้ใช้ grid ที่ 1
        }
      ]
</pre>
</div>
	    


<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Input" class="tabcontent">
<pre>
//TODO remove arrow CSS
input::-webkit-calendar-picker-indicator {
opacity: 0;
}
</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="CSS" class="tabcontent">
<pre>
//TODO CSS
document.documentElement.style.setProperty('--primary', 'red');

$primary: var(--primary);

.loo {
  background-color: $primary
}
</pre>
</div>



<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="RouteGuard" class="tabcontent">
<pre>
//TODO RouteGuard
ng g g ชื่อ
ชื่อ.guard.ts

import { Injectable } from '@angular/core';
import { ActivatedRouteSnapshot, CanActivate, RouterStateSnapshot, UrlTree, Router } from '@angular/router';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class RouteguardGuard implements CanActivate {

  constructor(private router: Router) { }
  canActivate(
    route: ActivatedRouteSnapshot,
    state: RouterStateSnapshot): boolean {
    let data_login = JSON.parse(`${localStorage.getItem('IT-asset-takeout-login')}`)
    if (data_login.access == "admins") {
      return true
    }
    this.router.navigate(['/'])
    return false
  }

}

}

app-routing.module.ts
import { ชื่อGuard } from './routeguard/ชื่อ.guard';
{ path: 'ITAssetTakeout', component: ITAssetTakeoutComponent,canActivate:[ชื่อGuard] },

</pre>
</div>






<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Map" class="tabcontent">
<pre>
//TODO insert data
this.data = this.data.map((d: any) => {
          return {
            ...d,
            ng: [{ value: 0 }]
          }
        })
this.data = this.data.map((d: any) => {
        return {
          name: d
        }
      })
	  
	  
//TODO เอา 2 มารวม
let newData = this.dataOld.map((dataNew:any,i:any)=>{
        return {
          ...dataNew,...this.dataNew[i]
        }
      })

//TODO แก้ไขบางตัว
this.data = this.data.map((d: any) => {
        return {
          ...d,
	  <mark>data</mark>:"a"
        }
      })
</pre>




</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Excel" class="tabcontent">
<pre>
/input hidden type="file" id="files" (change)="def_import($event)" multiple="false"/
/label class="btn btn-info mr-5" for="files" // i class="bi bi-box-arrow-in-down" style="font-size: 1rem;" ///i/Import Master Database//label/


//TODO text Excel XLSXjs
worksheet.getCell(label).value = { 'richText': [{ 'text': <mark>'testText'</mark>,'font': { 'bold': true, 'size': 16, 'name': 'Calibri' }}] }


//TODO ExportExcel
npm i --save-dev @types/file-saver
npm install file-saver

import * as ExcelJS from 'ExcelJs';
import { Cell, Row, Workbook, Worksheet } from 'ExcelJs';\

import { Workbook } from 'exceljs';
import * as fs from 'file-saver';
worksheet: any;
	
//error
หน้า tsconfig.json กับ  tsconfig.app.json
"compilerOptions": {
 "typeRoots": [
      "node_modules/@types"
    ],
   "types": ["node"]
}


constructor(
    private api: HttpService,
    private http: HttpClient
  ) { }


ExportExcel() {
    if (this.data.length > 0) {
      this.http.get('assets/ExportReport.xlsx', { responseType: "arraybuffer" })
        // this.http.get('http://localhost:4200/mastereletrical/report product electrical space.xlsx', { responseType: "arraybuffer" })
        .subscribe(
          data => {
            // console.log(data);
            const workbook = new Workbook();
            const arrayBuffer = new Response(data).arrayBuffer();
            let firstRow = 2
            arrayBuffer.then((data) => {
              workbook.xlsx.load(data)
                .then(() => {
                  let ABC = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z",
                    "AA", "AB", "AC", "AD", "AE", "AF", "AG", "AH", "AI", "AJ", "AK", "AL", "AM", "AN", "AO", "AP", "AQ", "AR", "AS", "AT", "AU", "AV", "AW", "AX", "AY", "AZ"
                    , "BA", "BB", "BC", "BD", "BE", "BF", "BG", "BH", "BI", "BJ", "BK", "BL", "BM", "BN", "BO", "BP", "BQ", "BR", "BS", "BT", "BU", "BV", "BW", "BX", "BY", "BZ"]
                  // console.log(ABC.split(""));
                  const worksheet = workbook.getWorksheet(1);
                  // if (this.dataTable == 4) {
                  for (const [index, item] of this.data.entries()) {
                    worksheet.getCell(`A${index + firstRow}`).value = { 'richText': [{ 'text': `${item?.model}`, 'font': { 'bold': false, 'size': 11, 'name': 'arial' } }] }
                
                    alignment(worksheet, `A${index + firstRow}`, 'middle', 'center')
                   
                    border(worksheet, `A${index + firstRow}`, '000000', 'medium', 0, 1, 1, 1)
                  
                    fill(worksheet, `${ABC[i]}${index + firstRow}`, 'DDEBF7') //red
                     
                  }


                  workbook.xlsx.writeBuffer().then(async (data: any) => {
                    const blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
        
                    // let loo = await this.api.sendExcelData({ test: data }).toPromise()

                    fs.saveAs(blob, `Report.xlsx`);

               

                  });
                });
            });
          },
          error => {
            console.log(error);
          }
        );


      function Bold(str: string) {
        return { 'richText': [{ 'text': str, 'font': { 'bold': true, 'size': 16, 'name': 'Calibri' } }] };
      }

      function fill(worksheet: any, cell: string, color: string) {
        worksheet.getCell(cell).fill = {
          type: 'pattern',
          pattern: 'solid',
          fgColor: { argb: color },
        };
      }

      function border(ws: any, cells: string, colors: string, styles: string, tops: any, lefts: any, bottoms: any, rights: any) {
        ws.getCell(cells).border = {
          top: tops ? { style: styles, color: { argb: colors } } : null,
          left: lefts ? { style: styles, color: { argb: colors } } : null,
          bottom: bottoms ? { style: styles, color: { argb: colors } } : null,
          right: rights ? { style: styles, color: { argb: colors } } : null
        };
      }

      function alignment(ws: any, cells: string, verticals: string, horizontals: string) {
        ws.getCell(cells).alignment = { vertical: verticals, horizontal: horizontals };
      }
      function generateToken(n: number) {
        var chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        var token = '';
        for (var i = 0; i < n; i++) {
          token += chars[Math.floor(Math.random() * chars.length)];
        }
        return token;
      }
    }
  }


//TODO get&del
router.post("/getByCondition", function (req, res, next) {
  const payload = req.body;
  dataRecord.find(payload, function (err, rs) {
    if (err) {
      res.json(err);
    } else {
      res.json(rs);
    }
  });
});


//TODO 
  def_import(evt: any) {
    const target: DataTransfer = <DataTransfer>(evt.target);
    if (target.files.length !== 1) throw new Error('Cannot use multiple files');
    const reader: FileReader = new FileReader();

    reader.onload = async (e: any) => {
      /* read workbook */
      const bstr: string = e.target.result;
      const wb: XLSX.WorkBook = XLSX.read(bstr, { type: 'binary' });
      /* grab first sheet */

      const data: any[] = []
      const files = evt.target.files
      data.push(...files)
      console.log(data);
      this.MasterData(wb, data)
      // this.ImportExcelList(evt, wb, data)

    };
    reader.readAsBinaryString(target.files[0]);
  }


  async MasterData(wb: any, data: any) {
    const wsname: string = wb.SheetNames[0];
    const ws: XLSX.WorkSheet = wb.Sheets[wsname];

    // this.fullData = []
    let text = "OfficePC"
    if (wsname == text) {

    }

    // /* save data */
    this.dataExcel = <AOA>(XLSX.utils.sheet_to_json(ws, { header: 1 }));
    // console.log(this.dataExcel);

    console.log(this.dataExcel[0]);
   

  }

</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="ElementById" class="tabcontent">
<pre>
//TODO set value
let doos = document.getElementById("files").setAttribute<mark>("value","1337")</mark>
or
let doo = document.getElementById("files") as HTMLInputElement
<mark>doo.value = "asldas"</mark>
</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->

<div id="swal" class="tabcontent">
<pre>
//TODO Swal
allowOutsideClick: false

Swal.fire({
      title: 'Do you want to update data ?',
      icon: 'question',
      showCancelButton: true,
    }).then(async r => {
      if (r.isConfirmed) {
        //code start
        
        //code end
        setTimeout(() => {
          Swal.fire('Success', '', 'success')
        }, 200);
      }
    })

//TODO norti
Swal.fire({
          position: 'center',
          icon: 'success',
          title: 'Success',
          showConfirmButton: false,
          timer: 1500,
        })
</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->

<div id="button" class="tabcontent">
<pre>
//TODO hide
<...input type="file" id="files" class="hidden"/...>
<...label for="files">Select file</label...>


//Date
MaterialTime(date : any){
    let time = new Date();
    let dateNew
    if (date?.toString()?.split(".")[1]?.slice(3) == "Z") {
      dateNew = `${date.split("T")[0].split("-")[2]}/${date.split("T")[0].split("-")[1]}/${date.split("T")[0].split("-")[0]}`
    } else {
      let Dates = new Date(`${date.toString().split(" ")[0]} ${date.toString().split(" ")[1]} ${date.toString().split(" ")[2]} ${date.toString().split(" ")[3]} ${time.toString().split(" ")[4]} GMT+0700 (Indochina Time)`).toISOString().split("T")[0]
      dateNew = `${Dates.split("-")[2]}/${Dates.split("-")[1]}/${Dates.split("-")[0]}`
    }
    return dateNew
  }



//TODO login
let data = {
      user : this.username,
      password : this.password
    }
    let login = await this.api.LoginDST_Shipment(data).toPromise()


//TODO button
class="btn btn-primary"    Primary
class="btn btn-secondary"  Secondary
class="btn btn-success"    Success
class="btn btn-danger"     Danger
class="btn btn-warning"    Warning
class="btn btn-info"       Info
class="btn btn-light"      Light
class="btn btn-dark"       Dark
class="btn btn-link"       Link


function1Active = false;
  toggleFunction() {
    this.function1Active = !this.function1Active;
    if (this.function1Active) {
      this.filter_blacklist();
    } else {
      this.filter_back();
    }
  }



</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->

<div id="Storage" class="tabcontent">
<pre>
//TODO Storage
// Save data to sessionStorage
sessionStorage.setItem("key", "value");

// Get saved data from sessionStorage
let data = sessionStorage.getItem("key");

// Remove saved data from sessionStorage
sessionStorage.removeItem("key");

// Remove all saved data from sessionStorage

sessionStorage.clear();

JSON.stringify(storeData)
localStorage.setItem("AMT-ComputerName", JSON.stringify(res))
JSON.parse(`${localStorage.getItem("storeData")}`)
</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->

<div id="Save" class="tabcontent">
<pre>
//TODO save image
function save() {
      let html : any = document.getElementById('print');
      html2canvas(html, {
        useCORS: true,
        allowTaint: true,
        // scale:2
      }).then((canvas) => {
        const image = canvas.toDataURL('png');
        const a = document.createElement('a');
        a.setAttribute('download', 'certificate.png');
        a.setAttribute('href', image);
        a.click();
      })
    }


//TODO save pdf
printPdf() {
    // save()
    let p1: any
    let w = 107;
    let h = 56;
    let quality = 2
    let pdf: any
      p1 = document.querySelectorAll('#print')[i]
      pdf = new jsPDF('l', 'mm', [106.5, 55.5]);
        html2canvas(p1,W
          { scale: quality }
        ).then(canvas => {
          pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, w, h);
          pdf.save('page1.pdf')
          // resolve(pdf)
        }); 
  }



</pre>
</div>



<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="NodeJS" class="tabcontent">
<pre>
//TODO SendMail

<mark>var fs = require("fs");</mark>
<mark>const { Blob } = require("buffer");</mark>
<mark>const nodemailer = require("nodemailer");</mark>

router.post("/sendMail", async function (req, res, next) {
  let transporter = nodemailer.createTransport({
    host: "smtp.office365.com",
    port: 587,
    secure: false,
    auth: {
      <mark>user: "thaksin-b@kyocera.co.th",</mark>
      <mark>pass: "TB@th068822",</mark>
    },
    // auth: mail[0].auth,
  });

  try {
    let users = await Users.find({}).exec()
    users = users.map(d=>
      d.email
    )
    console.log(users);
    let buffer = Buffer.from(req.body.test.data);
    let info = await transporter.sendMail({
      <mark>from: "thaksin-b@kyocera.co.th",</mark> // sender address
      <mark>to: "thaksin-b@kyocera.co.th",</mark> // list of receivers
      <mark>cc: users,</mark>
      <mark>subject: "Test DST-Shipment Mail", </mark>// Subject line
      html:
        `Dear All<br/><br/>
        We have checked and confirmed all pallets for today's shipment<br/>
        Pls see shipment list in the attached<br/><br/>
        Best Regards,<br/>
        ${req.body.name}`,
      attachments: [
        {
          filename: "DST Shipment Confirm.xlsx",
          content: buffer,
        },
      ],
    });
    res.json(info);
  } catch (error) {
    console.log("@error", error);
  }
});


//   fs.writeFile("report.xlsx", buffer, function (err) {
//     if (err) throw err;
//     // console.log("Saved!");
//   });

</pre>


<pre>
const { ObjectId } = require('mongodb');
	
router.post("/updateAt/", function (req, res, next) {
  const payload = req.body;
  monthly_shipment.findOneAndUpdate(
    { date: payload.date }, // ค้นหาข้อมูลที่มีฟิลด์ a ตรงกับ payload
    { $set: payload }, // อัพเดทข้อมูล
    { upsert: true, new: true }, // ถ้าไม่มีข้อมูลที่ตรงกัน ให้เพิ่มใหม่ และส่งข้อมูลที่อัพเดทแล้วกลับมา
    (err, result) => {
      if (err) {
        res.json(err);
      } else {
        res.json(result);
      }
    }
  );
});

router.post("/UpdateAdd", function (req, res, next) {
  const payload = req.body;  
  if (!payload._id) {
    payload._id = new ObjectId(); 
  }
  route.findOneAndUpdate(
    { _id: payload._id },
    { $set: payload },
    { upsert: true, new: true }, 
    (err, result) => {
      if (err) {
        res.json(err);
      } else {
        res.json(result);
      }
    }
  );
});
</pre>

<pre>
	
</pre>
//TODO convert data image
import { map } from 'rxjs/operators';	
const url = await lastValueFrom(
this.http.get(this.img.imgs[0].path, { responseType: 'blob' }).pipe(
map((blob: Blob) => URL.createObjectURL(blob))
)
);
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->

<div id="Material" class="tabcontent">
<pre>
<mark>//TODO Table</mark>
import {ViewChild} from '@angular/core';
import {MatPaginator} from '@angular/material/paginator';
import {MatTableDataSource} from '@angular/material/table';

displayedColumns: string[] = ['Model'];
dataSource = new MatTableDataSource<any>
@ViewChild(MatPaginator) paginator:any =  MatPaginator;

this.dataSource = new MatTableDataSource(this.data)
this.dataSource.paginator = this.paginator;

&ltdiv class="mat-elevation-z8"&gt
  &lttable mat-table [dataSource]="dataSource"&gt

    &ltng-container matColumnDef="Model"&gt
      &ltth mat-header-cell *matHeaderCellDef&gt No. &lt/th&gt
      &lttd mat-cell *matCellDef="let element"&gt {{element.Model}} &lt/td&gt
    &lt/ng-container&gt

    &lttr mat-header-row *matHeaderRowDef="displayedColumns"&gt&lt/tr&gt
    &lttr mat-row *matRowDef="let row; columns: displayedColumns;"&gt&lt/tr&gt
  &lt/table&gt

  &ltmat-paginator [pageSizeOptions]="[5, 10, 20]"
                 showFirstLastButtons
                 aria-label="Select page of periodic elements"&gt
  &lt/mat-paginator&gt
&lt/div&gt


<mark>//TODO filter</mark>
&ltmat-form-field appearance="standard"&gt
	&ltmat-label&gtFilter&lt/mat-label&gt
	&ltinput matInput (keyup)="applyFilter($event)" placeholder="Search columns" #input&gt
&lt/mat-form-field&gt


.ts
applyFilter(event: Event) {
    const filterValue = (event.target as HTMLInputElement).value;
    this.dataSource.filter = filterValue.trim().toLowerCase();
  }
  
  
  
  
//calendar
&lt;div class="row"&gt;
  &lt;div style="margin: 14px;"&gt;
    &lt;mat-form-field appearance="fill"&gt;
      &lt;mat-label&gt;Choose a date&lt;/mat-label&gt;
      &lt;!-- นำข้อความทั้งหมดมาแสดงผล --&gt;
      &lt;input matInput value="Your entire text goes here"&gt;
      &lt;input matInput [matDatepicker]="picker" hidden&gt;
      &lt;mat-datepicker-toggle matSuffix [for]="picker"&gt;&lt;/mat-datepicker-toggle&gt;
      &lt;mat-datepicker #picker startView="year" (monthSelected)="setMonthAndYear($event,picker)"&gt;&lt;/mat-datepicker&gt;
    &lt;/mat-form-field&gt;
  &lt;/div&gt;
&lt;/div&gt;


setMonthAndYear(normalizedMonthAndYear: any , datepicker :any) {
    this.dateSelect = normalizedMonthAndYear
    datepicker.close();
    this.updateInput()
  }

	  
	  
</pre>
</div>


<!--------------------------------------------------------------------------------------------------------------------------------------------->


<div id="Install" class="tabcontent">
<pre>
<mark>//TODO Awesome</mark>
https://fontawesome.com/download
6.4.0 For The Web
Free For Web
เอาไฟล์ไว้ใน assets

https://fontawesome.com/docs/web/setup/host-yourself/webfonts

Index.html
ใส่ใน Head
&ltlink href="/your-path-to-fontawesome/css/fontawesome.css" rel="stylesheet"&gt
&ltlink href="/your-path-to-fontawesome/css/brands.css" rel="stylesheet"&gt
&ltlink href="/your-path-to-fontawesome/css/solid.css" rel="stylesheet"&gt


</pre>
</div>


<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Dialog" class="tabcontent">
<pre>
//TODO Dialog
import { MatDialog } from '@angular/material/dialog';

constructor(
    private dialog: MatDialog
  ) { }

edit(item: any) {
    console.log(item);
    let closeDialog = this.dialog.open(<mark>EditMasterModelComponent</mark>, {
      width: '1000px',
      data: item
    });
    closeDialog.afterClosed().subscribe(close => {
    })
  }

<mark>New com</mark>
import { Component, OnInit, Inject } from '@angular/core';
import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';
constructor(
    private dialog: MatDialogRef&ltany&gt,
    @Inject(MAT_DIALOG_DATA) public <mark>data: any</mark>,
    private api : HttpService
  ) { }
this.dialog.close()

</pre>
</div>


<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Object" class="tabcontent">
<pre>
//TODO ChecK Empty
console.log(Object.keys(this.data).length); // 0
</pre>
</div>


<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="CPN" class="tabcontent">
<pre>
//TODO Emit
 @Output() dataChange : EventEmitter<any> = new EventEmitter()
this.dataChange.emit()
</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="MongoDB" class="tabcontent">
<pre>
let koo = await lastValueFrom(this.api.BomList_UpdateBigData(this.rowData))
	
const { ObjectId } = require("bson");
router.post("/updateBigData/", async function (req, res, next) {
  const payload = req.body;
  const formUpdate = payload.map(d => {
    if (d._id) {
      return {
        updateMany: {
          filter: { _id: new ObjectId(d._id) },
          update: { $set: d },
        },
      }
    } else {
      return {
        insertOne: {
          document: d
        }
      }
    }
  })
  const resultUpdate = await PM_ISSUE.bulkWrite(formUpdate)
	
  res.json({});
});

</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="AG_Grid" class="tabcontent">
<pre>
pinnedBottomRowData: [
   { "No": 999 }
]
cellStyle: { borderRight: '1px solid #ccc' },
//TODO
      {
        field: "Model", width: 120,
        pinned: 'left',
        cellClass: 'color',
        editable: true,
        onCellValueChanged: this.onCellValueChanged.bind(this),
      }



	field.push(
        {
          field: `${moment(iterator).format("MMM YYYY")}`,
          width: 120,
          wrapHeaderText: true,
          autoHeaderHeight: true,
          headerClass: 'setCenter',
          children: [
            { headerName: "Strt Yield", field: `${moment(iterator).format('M')}_Strt`, cellClass: 'colorYieldlock' },
            { headerName: "Total Yield", field: `${moment(iterator).format('M')}_Total`, cellClass: 'colorYieldlock' },
            { headerName: "PU Yield", field: `${moment(iterator).format('M')}_PU`, cellClass: 'colorYield' }
          ]
        },
      )

async onCellValueChanged(params: any) { ...  }


<ag-grid-angular #myGrid style="width: 100% ;height: 32rem" class="ag-theme-quartz"
        [gridOptions]="gridOptions"
        [rowData]="rowData"
        [columnDefs]="columnDefs"
        [animateRows]="true"
        [enableCellTextSelection]="true"
        [ensureDomOrder]="true"
        [tooltipMouseTrack]="true"
        [tooltipShowDelay]="0"
        ></ag-grid-angular>
		
check(){
    this.grid!.api!.forEachNodeAfterFilter(function (rowNode :any, index:any) {
      console.log(rowNode);
    });
  }
  
  import { AgGridAngular } from 'ag-grid-angular';
@ViewChild('myGrid') grid!: AgGridAngular;


suppressMovable: true,
headerCheckboxSelection: true,
checkboxSelection: true,

cellRenderer:  () => {
  return '<button class="btn btn-info">action</button>';
}

cellRenderer: () => {
  const button = document.createElement('button');
  button.innerHTML = 'Photo';
  button.classList.add('btn', 'btn-info')
  button.addEventListener('click', this.onBtnClick1.bind(this));
  return button;
}

cellRenderer: (data:any) => {
  const button = document.createElement('button');
  button.innerHTML = `${data.value}`;
  button.classList.add('btn', 'btn-info' , 'setFull')
  button.setAttribute('id', 'setBtn_action')
  button.addEventListener('click', (event) => this.onBtnClick1(event, 'sss'));
  return button;
}
//async onBtnClick1(event: any, value: any, month: any)

onRowDataUpdated : (data:any)=>{} //ทุกครั้งที่มีการอัพเดท

valueGetter: function (params: any) {
  if (params.data.value && params.data.value.length > 0) {
	let value = params.data.value[3]['PU']
	return value ? value : ''
  }
  return '';
},


valueGetter: function (params: any) {
          params.colDef.cellClass = 'Color_YELLOW'
          console.log("🚀 ~ InputPlanComponent ~ setDataListCol ~ kpp:", params)
          let value = params.data.Model

          // return value ? value : ''
          return value
        },
		
		
var elements = document.querySelectorAll('.ag-body-viewport.ag-selectable.ag-layout-normal.ag-row-no-animation');
    let width: any
    elements.forEach(function (element) {
      var style = getComputedStyle(element);
      width = parseInt(style.width);
    });

 ag-grid-angular #myGrid
 @ViewChild('myGrid') grid!: AgGridAngular;

onFilterChanged: (data: any) => {
      let dateFilter: any = [];
      data.api.forEachNodeAfterFilterAndSort((node: any, index: any) => {
        node.data.No = index + 1;
        dateFilter.push(node.data);
      });
      let loo = this.grid.api?.getDisplayedRowCount();
      console.log("🚀 ~ InputCompareComponent ~ loo:", loo)
      // this.gridOptions.api.getDisplayedRowCount()
      data.api!.applyTransaction(dateFilter);
    },
//TODO 
gridOptions: any = {
    accentedSort: true,
    rowSelection: 'multiple',
    headerHeight: 22,
    defaultColDef: {
      lockPinned: true,
      filter: true,
      floatingFilter: true,
      floatingFilterComponentParams: {
        suppressFilterButton: true,
      },
      suppressMovable: true,

    },

    onFilterChanged: (data: any) => {
      let dateFilter: any = [];
      data.api.forEachNodeAfterFilterAndSort((node: any, index: any) => {
        node.data.No = index + 1;
        dateFilter.push(node.data);
      });
      let loo = this.grid.api?.getDisplayedRowCount();
      this.refresh(dateFilter)
    },

    <mark>pinnedBottomRowData: [{}]</mark>
  }

	  refresh(e: any) {

    let data = e.filter((d: any) => d.value.length != 0)

    if (e.length != 0) {
      for (const [index, item] of e[0].value.entries()) {
        let name_head = `${moment(item.data.split(' / ')[1].split('月')[0].split('年')[1]).format('MMM')}-${moment(item.data.split(' / ')[1].split('月')[0].split('年')[0]).format('YY')}`
        // console.log(index);
        // console.log(name_head);
        // console.log(e.reduce((a:any,b:any)=>a+b?.value[index].value,0));

        // this.gridOptions.pinnedBottomRowData[name_head] = Math.random()
      }
    }

    this.gridOptions.pinnedBottomRowData[0]['Oct-23'] = Math.random();
    this.gridOptions.pinnedBottomRowData[0]['Nov-23'] = Math.random();
    this.grid.api.redrawRows()
    this.grid.api.refreshCells()


  }
//TODO
@ViewChildren('myGrid') grids: QueryList<AgGridAngular>;
this.grids.forEach((grid, index) => {
    const pinnedTopRowData = [{ Qty: (index + 1).toString() }];
    grid.api.setPinnedTopRowData(pinnedTopRowData);
    grid.api.redrawRows();
});
</pre>
</div>




<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Holiday" class="tabcontent">
<pre>
//TODO Api
MasterHoliDay(): Observable<any> {
    return this.http.get("http://10.200.90.152:4012/date_masterGet")
  }
this.holiday = await lastValueFrom(this.api.MasterHoliDay())


myFilter = (d: Date | null): boolean => {
    const day = (d || new Date()).getDay();
    let date = moment(d).format().split("T")[0].toString()
    let holiday = this.holiday?.filter((e: any) => e["date"].match(new RegExp(date, "i")));
    return holiday?.length == 0 && day !== 0
  };

input matInput [matDatepickerFilter]="myFilter"


</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Copy" class="tabcontent">
<pre>
//TODO Copy cb

copyToClipboard(text: string) {
    const el = document.createElement('textarea');
    el.value = text;
    document.body.appendChild(el);
    el.select();
    document.execCommand('copy');
    document.body.removeChild(el);
  }


</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="ElementNative" class="tabcontent">
<pre>
//TODO ts
@ViewChild('targetElement1') targetElement1: any = ElementRef;
@ViewChild('targetElement2') targetElement2: any = ElementRef;
@ViewChild('targetElement3') targetElement3: any = ElementRef;

scrollToElement(point:any) {
    if (point == 1) {
      this.targetElement1.nativeElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
    if (point == 2) {
      this.targetElement2.nativeElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
    if (point == 3) {
      this.targetElement3.nativeElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
}


#targetElement1
//TODO use
(click)="scrollToElement(3)"

</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Date" class="tabcontent">
<pre>
//TODO convert_time
date : new Date(moment(d.date).add(7,'hour').format()).toISOString()

</pre>
</div>

	
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="PrimeNG" class="tabcontent">
<pre>
//TODO PrimeNG

npm i primeng

"styles": [
    "node_modules/primeicons/primeicons.css",
    "node_modules/primeng/resources/themes/lara-light-blue/theme.css",
    "node_modules/primeng/resources/primeng.min.css",
    ...
]
</pre>
</div>
	
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="Autocomplete" class="tabcontent">
<pre>
//TODO 
&lt;mat-form-field appearance="outline" floatLabel="always" class="setFormat">
  &lt;mat-label>Customer&lt;/mat-label>
  &lt;input type="text" matInput style="text-align: center;" [matAutocomplete]="auto_3"
    [(ngModel)]="rawData['Customer']">
  &lt;mat-autocomplete #auto_3="matAutocomplete">
    &lt;mat-option *ngFor="let option of filterOptions(rawData['Customer'],customer)" [value]="option.list">
      {{option.list}}
    &lt;/mat-option>
  &lt;/mat-autocomplete>
&lt;/mat-form-field>



customer: any = {}
rawData: any = {}
	
this.rawData.Customer = ''
    this.customer = [
      {
        list: "111"
      },
      {
        list: "222"
      }
    ]
	
filterOptions(list: string, data: any) {
    const filterValue = list?.toLowerCase();
    return data.filter((option: any) => option?.list?.toLowerCase().includes(filterValue));
  }
	
	
</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->

	
<div id="Number" class="tabcontent">
<pre>
 let list = [
      "0.00000000",
      "0.0000000",
      "0.000000",
      "0.00000",
      "0.0000",
      "0.000",
      "0.00",
      "0.0",
      "0.",
    ]
    let regex = 0
    for (const item of list) {
      regex = regex + 1
      if (value?.split(item).length > 1) {
	break
      }
    }
    return regex == 9 ? value : Number(value).toFixed(9 - regex + 3)

</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="HTML" class="tabcontent">
<pre>
&lt;div class="grid-container"&gt;
  &lt;div class="grid-item"&gt;1&lt;/div&gt;
  &lt;div class="grid-item"&gt;2&lt;/div&gt;
  &lt;div class="grid-item"&gt;3&lt;/div&gt;
&lt;/div&gt;

//.grid-container {
  display: grid;
  grid-template-columns: repeat(3, 1fr); /* 3 columns */
  grid-template-rows: repeat(2, 1fr);    /* 2 rows */
  gap: 10px; /* Optional: gap between items */
}//
	
</pre>
</div>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="PDF" class="tabcontent">
<pre>
npm install jspdf --save
npm install --save html2canvas
import { jsPDF } from "jspdf";
import html2canvas from 'html2canvas';
id="print"

//TODO TS.
generatePDF(name: string) {
    try {
      setTimeout(async () => {
        const div: any = document.querySelectorAll('#print');
        const options = {
          background: 'white',
          scale: 3,
        };
        var doc: any = new jsPDF('l', 'mm', [75, 50.8]);
        // doc.setPageSize(51,24)
        for (let index = 0; index < div.length; index++) {
          const d = div[index];
          const can = await html2canvas(d, options)
          let img = can.toDataURL('image/PNG');
          const bufferX = 0;
          const bufferY = 0;
          const imgProps = (<any>doc).getImageProperties(img);
          const pdfWidth = doc.internal.pageSize.getWidth() - 2 * bufferX;
          const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

          if (div.length === 1) {
            doc = await doc.addImage(
              img,
              'PNG',
              bufferX,
              bufferY,
              pdfWidth,
              pdfHeight,
              undefined,
              'FAST'
            );
            await doc.save(`${name}.pdf`);
            // this.router.navigate(['user/print'])
          } else {
            if (index === 0) {
              doc = await doc.addImage(
                img,
                'PNG',
                bufferX,
                bufferY,
                pdfWidth,
                pdfHeight,
                undefined,
                'FAST'
              );
            } else {
              doc = await doc.addPage('l');
              doc = await doc.addImage(
                img,
                'PNG',
                bufferX,
                bufferY,
                pdfWidth,
                pdfHeight,
                undefined,
                'FAST'
              );
              if (index + 1 === div.length) {
                await doc.save(`${name}.pdf`);
                // this.router.navigate(['user/print'])
              }
            }
          }



        }
      }, 300);
    } catch (error) {
      console.log("🚀 ~ error:", error)

    }

  }

</pre>
</div>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<div id="QR_Code" class="tabcontent">
<pre>
npm i --save-dev @types/qrcode --force
import * as QRCode from 'qrcode'
this.qr = await QRCode.toDataURL('ssssssssssssssssssssssssssss')
img url=qr w=100 h=100
</pre>
</div>

<!-- QR_Code -->


<script>
function openCity(evt, cityName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>
   
</body>
</html> 
